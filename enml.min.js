ENML={parser: function(){function j(a,d,e){this.parent=e;this.children=[];this.children.each=function(c){for(var i=this.length,f=0;f<i;f++)c(this[f])};this.is=d;this.val=a;this.attr={}}function k(){var a=new j("","root",null);this.root=a;this.open=function(d){node=new j(d,"tag",a);a.children.push(node);a=node};this.set=function(d,e){a.is="attr_tag";a.attr[d]=e};this.add=function(d){a.children.push(new j(d,"text",a))};this.close=function(){if(a.parent)a=a.parent}}var g,b=[],h={open:/^[\s]*\[/,closed:/^[\s]*]/,
name:/^[\s]*([A-Za-z0-9_-]+):/,attr:/^[\s]*([A-Za-z0-9_-]+)[\s]*=[\s]*('[^']+'|"[^"]")/,text:/^[\s]*[^\]\[]+/,reference:/^[\s]*([0-9]+):/};this.parse=function(a){b=a;for(g=new k;b;){if(a=b.match(h.text)){g.add(a[0]);b=b.substring(a[0].length)}a=b.match(h.open);var d=b.match(h.closed),e=false;if(a){e=a;e.open=true}if(d){e=d;e.open=false}if(a=e)if(a.open){b=b.substring(a[0].length);if(a=b.match(h.name)){g.open(a[1]);b=b.substring(a[0].length);for(a=true;a;)if(d=b.match(h.attr)){g.set(d[1],d[2].substring(1,
d[2].length-1));b=b.substring(d[0].length)}else a=false}}else{g.close();b=b.substring(a[0].length)}else b=false}return g.root.children}}, grammar: function(j){function k(c){this.name=c;this.attr={};this.template="";this.force=false;this.aliases=[]}function g(c){typeof e.exiting[a.state]=="function"&&e.exiting[a.state]();a.state=c;typeof e.starting[a.state]=="function"&&e.starting[a.state]()}function b(c){return g!=c?false:true}function h(c){var i="";c.each(function(f){switch(f.is){case "text":i+=f.val;break;case "tag":i+=a.definitions[f.val].template.replace("%TC",h(f.children));break;case "attr_tag":var l=a.definitions[f.val].template.replace("%TC",
h(f.children));for(arg in f.attr)l=l.replace("%"+arg.toUpperCase(),f.attr[arg]);i+=l}});return i}var a=this,d=new ENML.parser,e={starting:{},exiting:{}};a.name=j;a.definitions={};a.state="uninitialized";a.define=function(c){g("defining");a.indefinite=new k(c);if(arguments>1)a.indefinite.aliases=arguments.slice(1);return a};a.by_force=function(){b("defining");a.indefinite.force=true;return a};a.plus=function(c){b("defining");a.indefinite.attr=c;return a};e.exiting.defining=function(){if(typeof a.definitions[a.indefinite.name]!=
"undefined"){if(a.indefinite.force)a.definitions[a.indefinite.name]=a.indefinite}else a.definitions[a.indefinite.name]=a.indefinite};a.as=function(c){b("defining");a.indefinite.template=c;g("ready");return a};a.as.cssProxy=function(c){b("defining");a.indefinite.template="<"+c+" class='"+a.indefinite.name+"'>%TC</+'"+c+">";g("ready");return a};a.parse=function(c){return h(d.parse(c))}}}